<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KC控制台</title>

    <script src="https://unpkg.com/vue@3.4.27/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/dayjs/dayjs.min.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/customParseFormat.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekday.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/localeData.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekOfYear.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekYear.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/advancedFormat.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/quarterOfYear.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus/dist/index.css"
    />
    <link
      type="text/css"
      href="https://unpkg.com/ant-design-vue@4.2.3/dist/reset.css"
      media="screen"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/ant-design-vue@4.2.3/dist/antd.min.js"></script>

    <!-- 使用内联SVG图标替代图标库 -->
    <style>
      .demo-table {
        margin: 20px;
      }
      .expand-row {
        padding: 20px;
        background-color: #f5f7fa;
      }
      .detail-item {
        margin-bottom: 10px;
      }
      /* 自定义图标样式 */
      .custom-icon {
        display: inline-flex;
        align-items: center;
        line-height: 0;
        text-align: center;
        vertical-align: -0.125em;
        fill: currentColor;
        margin-right: 8px; /* 增加图标与文字之间的间距 */
      }

      .custom-icon svg {
        width: 1em;
        height: 1em;
      }

      /* 按钮中的图标间距 */
      .ant-btn .anticon {
        margin-right: 8px;
      }

      /* 确保按钮中的自定义图标有足够间距 */
      .ant-btn .custom-icon {
        margin-right: 8px;
      }

      /* 表格展开图标样式 */
      .ant-table-row-expand-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        color: #1890ff;
        line-height: 24px;
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.3s;
      }

      .ant-table-row-expand-icon:hover {
        color: #40a9ff;
      }

      .logo {
        font-size: 1.5rem;
        font-weight: bold;
        margin: 0 2rem 0 1rem;
        color: rgb(24, 144, 255);
      }

      .user-counter {
        color: rgb(24, 144, 255);
        font-weight: 500;
        margin: 0px 3px;
      }

      .user-text {
        color: #666;
      }

      .version-title {
        color: #1890ff;
      }

      .nav-container {
        display: flex;
        align-items: center;
        height: 100%;
        padding: 0 20px;
      }

      .nav-item {
        margin-right: 32px;
        cursor: pointer;
        position: relative;
        transition: all 0.3s;
        color: rgba(0, 0, 0, 0.88);
      }

      .nav-item:hover {
        color: #1890ff;
      }

      .nav-item.active {
        color: #1890ff;
      }

      .nav-item.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: #1890ff;
      }

      :where(.css-1p3hq3p).ant-table-wrapper .ant-table-thead > tr > th,
      :where(.css-1p3hq3p).ant-table-wrapper .ant-table-tbody > tr > td,
      :where(.css-1p3hq3p).ant-table-wrapper tfoot > tr > th,
      :where(.css-1p3hq3p).ant-table-wrapper tfoot > tr > td {
        padding: 4px;
      }

      .ant-table-wrapper {
        margin-bottom: 16px;
      }

      .ant-btn-link {
        padding: 0;
        height: auto;
        line-height: inherit;
      }

      .ant-table-row.ant-table-row-level-0 > .ant-table-cell:nth-child(7) {
        color: #1677ff;
        cursor: pointer;
      }

      /* 添加以下移动设备适配样式 */
      @media screen and (max-width: 768px) {
        body {
          min-width: 1200px;
          /* 设置最小宽度，保持原有布局 */
          overflow-x: auto;
          /* 允许横向滚动 */
          -webkit-overflow-scrolling: touch;
          /* iOS 滚动优化 */
        }

        #app {
          width: 1200px;
          /* 固定宽度 */
          overflow-x: visible;
        }

        .ant-layout {
          width: 100%;
          min-width: 1200px;
        }

        /* 固定头部，但保持在可滚动区域内 */
        .ant-layout-header {
          width: 1200px;
          position: sticky !important;
          top: 0;
          z-index: 999;
        }
      }

      /* 优化触摸滚动体验 */
      * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
      }

      /* 添加表格行选中样式 */
      .ant-table-row-selected > td {
        background-color: #e6f7ff !important;
      }

      .ant-table-row:hover > td {
        background-color: #f5f5f5;
      }
    </style>
  </head>

  <body>
    <div id="app">
      <a-layout>
        <a-layout-header
          style="
            padding: 0;
            background: #fff;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 999;
            box-shadow: 2px 5px 5px #eee;
          "
        >
          <div class="logo" style="padding-left: 20px">
            <a href="#" style="color: #1890ff; text-decoration: none"
              >KC控制台</a
            >
          </div>
          <div class="nav-container">
            <div
              class="nav-item"
              :class="{ active: activeTab === '1' }"
              @click="switchTab('1')"
            >
              综合界面
            </div>
            <div
              class="nav-item"
              :class="{ active: activeTab === '2' }"
              @click="switchTab('2')"
            >
              使用说明
            </div>
          </div>
          <div
            style="
              position: absolute;
              right: 20px;
              top: 0;
              height: 64px;
              display: flex;
              align-items: center;
            "
          >
            <span class="user-counter">{{ onlineUsers }}</span>
            <span class="user-text">666666</span>
          </div>
        </a-layout-header>
        <a-layout style="background-color: #fff">
          <a-layout-content
            style="margin: 0; min-height: 280px"
            :style="{padding: activeTab === '1'?'24px':'0'}"
          >
            <!-- 添加Modal组件 -->
            <a-modal
              v-model:visible="isModalVisible"
              title="脚本设置"
              width="1000px"
              style="top: 20px"
              :bodyStyle="{
                maxHeight: 'calc(100vh - 200px)',
                height: '600px',
                overflow: 'auto',
                padding: '24px'
              }"
            >
              <template #footer>
                <div style="text-align: left">
                  <a-button
                    type="primary"
                    @click="handleStart"
                    style="margin-right: 8px"
                  >
                    <template #icon>
                      <component
                        :is="icons.PlayCircleOutlined"
                        style="margin-right: 8px"
                      />
                    </template>
                    启动
                  </a-button>
                  <a-button danger @click="handleStop">
                    <template #icon>
                      <component
                        :is="icons.DeleteOutlined"
                        style="margin-right: 8px"
                      />
                    </template>
                    停止
                  </a-button>
                </div>
              </template>
              <div style="min-height: 600px; margin-top: 16px">
                <a-form layout="inline" style="margin-bottom: 16px">
                  <a-form-item>
                    <!-- <input
                      type="file"
                      ref="scriptFileInput"
                      style="display: none"
                      @change="handleScriptFileChange"
                    /> -->
                    <a-select
                      v-model="selectedScriptFile"
                      style="width: 250px"
                      placeholder="选择脚本文件"
                      @change="handleScriptFileSelect"
                    >
                      <!-- 循环遍历每个文件夹 -->
                      <a-select-opt-group
                        v-for="folder in scriptTreeData"
                        :key="folder.key"
                        :label="folder.title"
                      >
                        <!-- 循环遍历文件夹内的每个脚本文件 -->
                        <a-select-option
                          v-for="script in folder.children"
                          :key="script.key"
                          :value="script.title"
                        >
                          {{ script.title }}
                        </a-select-option>
                      </a-select-opt-group>
                    </a-select>
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAdd"
                      >查看/修改</a-button
                    >
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAdd"
                      >全部写同步脚本</a-button
                    >
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAdd"
                      >全部写同步配置</a-button
                    >
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAdd"
                      >打开脚本目录</a-button
                    >
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAdd"
                      >初始化配置文件</a-button
                    >
                  </a-form-item>
                </a-form>

                <a-tabs v-model:activeKey="activeTabKey">
                  <a-tab-pane key="1" tab="脚本">
                    <div style="display: flex; height: 50vh">
                      <!-- 左侧文件列表 -->
                      <div
                        style="
                          width: 300px;
                          padding: 16px;
                          border-right: 1px solid #f0f0f0;
                          height: 100%;
                          overflow-y: auto;
                        "
                      >
                        <a-tree
                          :tree-data="scriptTreeData"
                          v-model:selectedKeys="selectedScriptKeys"
                          :default-expanded-keys="['folder-1', 'folder-2']"
                          @select="handleScriptSelect"
                        />
                      </div>

                      <!-- 右侧内容区域 -->
                      <div
                        style="
                          flex: 1;
                          padding: 16px;
                          height: 100%;
                          overflow-y: auto;
                        "
                      >
                        <a-textarea
                          v-model:value="currentScriptContent"
                          :rows="28"
                          :placeholder="selectedScriptKeys.length ? '在这里编辑脚本内容...' : '请先选择一个脚本文件'"
                          style="resize: none; width: 100%; height: 100%"
                        />
                      </div>
                    </div>
                    <!-- 底部按钮组 -->
                    <div
                      style="
                        padding: 16px;
                        border-top: 1px solid #f0f0f0;
                        background: white;
                      "
                    >
                      <div>
                        <a-input
                          v-model:value="newScriptName"
                          placeholder="输入新脚本名"
                          style="width: 18%; margin-bottom: 8px"
                        />
                      </div>
                      <div style="display: flex; gap: 8px">
                        <a-button type="primary" @click="handleNewScript">
                          <template #icon>
                            <component
                              :is="icons.FileAddOutlined"
                              style="margin-right: 8px"
                            />
                          </template>
                          新建脚本文件
                        </a-button>
                        <a-button
                          type="primary"
                          danger
                          @click="handleDeleteScript"
                          :disabled="!selectedScriptKeys.length"
                        >
                          <template #icon>
                            <component
                              :is="icons.DeleteOutlined"
                              style="margin-right: 8px"
                            />
                          </template>
                          删除选中脚本
                        </a-button>
                        <a-button
                          type="primary"
                          @click="handleRunScript"
                          :disabled="!selectedScriptKeys.length"
                        >
                          <template #icon>
                            <component
                              :is="icons.PlayCircleOutlined"
                              style="margin-right: 8px"
                            />
                          </template>
                          运行选中脚本
                        </a-button>
                      </div>
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="2" tab="设置">
                    <div style="padding: 16px">
                      <a-textarea
                        v-model:value="settingsContent"
                        :rows="20"
                        placeholder="在这里编辑设置内容..."
                        style="resize: none; width: 100%"
                      />
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="3" tab="狩猎">
                    <div style="padding: 16px">
                      <a-textarea
                        v-model:value="huntingContent"
                        :rows="20"
                        placeholder="在这里编辑狩猎相关内容..."
                        style="resize: none; width: 100%"
                      />
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="4" tab="保护">
                    <div style="padding: 16px">
                      <a-textarea
                        v-model:value="protectContent"
                        :rows="20"
                        placeholder="在这里编辑保护相关内容..."
                        style="resize: none; width: 100%"
                      />
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="5" tab="组队">
                    <div style="padding: 16px">
                      <a-textarea
                        v-model:value="teamContent"
                        :rows="20"
                        placeholder="在这里编辑组队相关内容..."
                        style="resize: none; width: 100%"
                      />
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="6" tab="物品">
                    <div style="padding: 16px">
                      <a-textarea
                        v-model:value="itemContent"
                        :rows="20"
                        placeholder="在这里编辑物品相关内容..."
                        style="resize: none; width: 100%"
                      />
                    </div>
                  </a-tab-pane>
                  <a-tab-pane key="7" tab="录制">
                    <div style="padding: 16px">
                      <!-- 顶部标签栏 -->

                      <!-- 两列布局 -->
                      <div
                        style="
                          display: flex;
                          height: 50vh;
                          min-height: 400px;
                          border: 1px solid #d9d9d9;
                          border-radius: 2px;
                        "
                      >
                        <!-- 左侧坐标列表 -->
                        <div
                          style="
                            width: 50%;
                            border-right: 1px solid #d9d9d9;
                            display: flex;
                            flex-direction: column;
                          "
                        >
                          <!-- 标题 -->
                          <div
                            style="
                              padding: 8px;
                              background-color: #f5f5f5;
                              border-bottom: 1px solid #d9d9d9;
                              font-weight: bold;
                            "
                          >
                            坐标
                          </div>

                          <!-- 坐标列表 -->
                          <div style="flex: 1; overflow-y: auto">
                            <a-table
                              :columns="[{ title: '坐标', dataIndex: 'coordinate', key: 'coordinate', align: 'left' }]"
                              :data-source="coordinateList"
                              :pagination="false"
                              size="small"
                              :showHeader="true"
                              :row-selection="{ 
                                type: 'radio',
                                selectedRowKeys: selectedCoordinateKeys, 
                                onChange: onCoordinateSelectChange 
                              }"
                              style="border: none"
                            >
                              <template #bodyCell="{ column, record, index }">
                                <template
                                  v-if="column.dataIndex === 'coordinate'"
                                >
                                  <div
                                    style="
                                      display: flex;
                                      justify-content: space-between;
                                      align-items: center;
                                    "
                                  >
                                    <span>{{ record.coordinate }}</span>
                                    <div>
                                      <a-button
                                        type="link"
                                        size="small"
                                        @click.stop="handleEditCoordinate(record, index)"
                                      >
                                        <template #icon>
                                          <component
                                            :is="icons.EditOutlined"
                                            style="color: #1890ff"
                                          />
                                        </template>
                                      </a-button>
                                      <a-button
                                        type="link"
                                        size="small"
                                        @click.stop="handleDeleteCoordinate(record, index)"
                                      >
                                        <template #icon>
                                          <component
                                            :is="icons.DeleteOutlined"
                                            style="color: #ff4d4f"
                                          />
                                        </template>
                                      </a-button>
                                    </div>
                                  </div>
                                </template>
                              </template>
                            </a-table>
                          </div>
                        </div>

                        <!-- 右侧怪物名列表 -->
                        <div
                          style="
                            width: 50%;
                            display: flex;
                            flex-direction: column;
                          "
                        >
                          <!-- 标题 -->
                          <div
                            style="
                              padding: 8px;
                              background-color: #f5f5f5;
                              border-bottom: 1px solid #d9d9d9;
                              font-weight: bold;
                            "
                          >
                            怪物名
                          </div>

                          <!-- 怪物名列表 -->
                          <div style="flex: 1; overflow-y: auto">
                            <a-table
                              :columns="[{ title: '怪物名', dataIndex: 'name', key: 'name', align: 'left' }]"
                              :data-source="coordinateNameList"
                              :pagination="false"
                              size="small"
                              :showHeader="true"
                              :row-selection="{ 
                                type: 'radio',
                                selectedRowKeys: selectedCoordinateNameKeys, 
                                onChange: onCoordinateNameSelectChange 
                              }"
                              style="border: none"
                            >
                              <template #bodyCell="{ column, record, index }">
                                <template v-if="column.dataIndex === 'name'">
                                  <div
                                    style="
                                      display: flex;
                                      justify-content: space-between;
                                      align-items: center;
                                    "
                                  >
                                    <span>{{ record.name }}</span>
                                    <div>
                                      <a-button
                                        type="link"
                                        size="small"
                                        @click.stop="handleEditCoordinateName(record, index)"
                                      >
                                        <template #icon>
                                          <component
                                            :is="icons.EditOutlined"
                                            style="color: #1890ff"
                                          />
                                        </template>
                                      </a-button>
                                      <a-button
                                        type="link"
                                        size="small"
                                        @click.stop="handleDeleteCoordinateName(record, index)"
                                      >
                                        <template #icon>
                                          <component
                                            :is="icons.DeleteOutlined"
                                            style="color: #ff4d4f"
                                          />
                                        </template>
                                      </a-button>
                                    </div>
                                  </div>
                                </template>
                              </template>
                            </a-table>
                          </div>

                          <!-- 右侧底部输入框和按钮 -->
                          <div
                            style="padding: 8px; border-top: 1px solid #d9d9d9"
                          >
                            <div style="margin-bottom: 8px">
                              <div style="display: flex; align-items: center">
                                <a-input
                                  v-model:value="newCoordinateName"
                                  placeholder="输入怪物名"
                                  style="flex: 1; margin-right: 8px"
                                />
                              </div>
                            </div>

                            <div style="margin-bottom: 8px">
                              <div style="display: flex; align-items: center">
                                <a-select
                                  v-model:value="monsterType"
                                  style="flex: 1"
                                  :options="[
                                    { value: 'attack', label: '攻击' },
                                    { value: 'avoid', label: '躲避' }
                                  ]"
                                />
                              </div>
                            </div>

                            <div style="display: flex; margin-bottom: 8px">
                              <a-button
                                type="primary"
                                @click="addCoordinateName"
                                style="flex: 1; margin-right: 4px"
                                >添加选中目标</a-button
                              >
                              <a-button
                                @click="manualAddCoordinateName"
                                style="flex: 1"
                                >手动添加</a-button
                              >
                            </div>
                            <div style="display: flex; margin-bottom: 8px">
                              <a-button
                                @click="modifyCoordinateName"
                                style="flex: 1; margin-right: 4px"
                                >修改</a-button
                              >
                              <a-button
                                @click="deleteCoordinateName"
                                style="flex: 1; margin-right: 4px"
                                >删除选中</a-button
                              >
                              <a-button
                                @click="clearCoordinateNames"
                                style="flex: 1"
                                >清空</a-button
                              >
                            </div>
                            <a-button style="width: 100%" @click="copyNameList"
                              >复制名字列表</a-button
                            >
                          </div>
                        </div>
                      </div>

                      <!-- 底部操作区域 -->
                      <div style="margin-top: 16px">
                        <!-- 坐标区域 -->
                        <div style="display: flex; margin-bottom: 8px">
                          <a-input
                            v-model:value="newCoordinate"
                            placeholder="坐标"
                            style="width: 350px; margin-right: 8px"
                          />
                        </div>

                        <!-- 左侧按钮组 -->
                        <div
                          style="display: flex; gap: 4px; margin-bottom: 8px"
                        >
                          <a-button type="primary" @click="addCoordinate"
                            >添加坐标</a-button
                          >
                          <a-button @click="deleteCoordinate"
                            >删除选中</a-button
                          >
                          <a-button @click="modifyCoordinate">修改</a-button>
                          <a-button @click="clearCoordinates">清空</a-button>
                          <div style="flex: 1"></div>
                          指令：
                          <a-select
                            v-model:value="coordinateType"
                            style="width: 120px"
                          >
                            <a-select-option value="attack"
                              >指令1</a-select-option
                            >
                            <a-select-option value="avoid"
                              >指令2</a-select-option
                            >
                          </a-select>
                          <a-button
                            style="background-color: #f0f0f0"
                            @click="showCommandDoc"
                            >指令说明文档</a-button
                          >
                        </div>

                        <!-- 复制路径按钮 -->
                        <div style="margin-bottom: 8px">
                          <a-button
                            type="primary"
                            style="width: 18%; text-align: left"
                            @click="copyPathFormat"
                            >复制全部路径代码到lua</a-button
                          >
                        </div>

                        <!-- 生成路径按钮 -->
                        <div style="margin-bottom: 8px">
                          <a-button
                            type="primary"
                            style="width: 18%; text-align: left"
                            @click="generatePathFormat"
                            >生成路径代码格式</a-button
                          >
                        </div>

                        <!-- 取当前地图ID -->
                        <div
                          style="
                            display: flex;
                            align-items: center;
                            margin-bottom: 8px;
                          "
                        >
                          <a-input
                            v-model:value="currentMapId"
                            style="width: 18%; margin-right: 8px"
                            placeholder="地图ID"
                          />
                        </div>

                        <div
                          style="
                            display: flex;
                            align-items: center;
                            margin-bottom: 8px;
                          "
                        >
                          <a-button
                            type="primary"
                            @click="getCurrentMapId"
                            style="width: 18%"
                            >取当前地图ID</a-button
                          >
                        </div>
                      </div>
                    </div>
                  </a-tab-pane>
                </a-tabs>
              </div>
            </a-modal>

            <!-- 配置器内容 -->
            <a-row v-if="activeTab === '1'">
              <a-col :span="5">
                <a-card title="更新日志" style="margin-right: 20px">
                  <a-timeline>
                    <a-timeline-item>
                      <div class="version-title">2025.03.10: 版本2.0.0</div>
                      <div>版面优化，交互优化</div>
                    </a-timeline-item>
                    <a-timeline-item>
                      <div class="version-title">2025.03.05: 版本1.1.2</div>
                      <div>增加神兵特效</div>
                      <div>增加主界面显示特效</div>
                    </a-timeline-item>
                    <a-timeline-item>
                      <div class="version-title">2025.02.28: 版本1.1.1</div>
                      <div>优化装备快速筛选功能</div>
                      <div>修复若干装备错误</div>
                      <div>增加图片分享功能演示视频</div>
                    </a-timeline-item>
                  </a-timeline>
                </a-card>
                <a-card title="联系我们" style="margin: 20px 20px 0 0">
                  <div>BUG反馈、建议意见、新版尝鲜</div>
                  <img
                    src="https://zxsj.akii.fun/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fqrcode.405f63d4.png&w=640&q=75"
                    style="width: 90%; display: block; margin: 0 auto"
                  />
                </a-card>
              </a-col>

              <a-col :span="19">
                <!-- 登录验证 -->
                <div style="margin-top: 1px">
                  <div style="margin-bottom: 16px">
                    <a-form layout="inline">
                      <a-form-item label="账号">
                        <a-input
                          v-model:value="user"
                          placeholder="Username"
                          style="width: 250px"
                        />
                      </a-form-item>

                      <a-form-item>
                        <a-button type="primary" @click="handleAdd"
                          >登录</a-button
                        >
                      </a-form-item>

                      <a-form-item>
                        <a-button type="dashed" @click="handleAdd"
                          >注册/充值</a-button
                        >
                      </a-form-item>

                      <a-form-item label="Gamepath">
                        <a-input
                          v-model:value="user"
                          placeholder="Gamepath"
                          style="width: 200px"
                        />
                      </a-form-item>

                      <a-form-item>
                        <a-button type="primary" @click="handleAdd">
                          <template #icon>
                            <component
                              :is="icons.SearchOutlined"
                              style="margin-right: 8px"
                            />
                          </template>
                          路径
                        </a-button>
                      </a-form-item>
                    </a-form>
                  </div>
                </div>

                <div id="container" style="padding: 24px" />
                <script>
                  const mountNode = document.getElementById("container");
                </script>

                <!-- 表格操作按钮 -->
                <div style="margin-bottom: 16px; display: flex; gap: 8px">
                  <!-- 移除展开所有和收起所有按钮 -->
                </div>

                <!-- 表格 -->
                <div id="appTable">
                  <div class="demo-table">
                    <el-table :data="tableData" style="width: 100%">
                      <el-table-column type="expand">
                        <template #default="props">
                          <div class="expand-row">
                            <div class="detail-item">
                              <strong>详细地址：</strong> {{ props.row.address
                              }}
                            </div>
                          </div>
                        </template>
                      </el-table-column>
                      <el-table-column
                        label="日期"
                        prop="date"
                      ></el-table-column>
                      <el-table-column
                        label="姓名"
                        prop="name"
                      ></el-table-column>
                      <el-table-column
                        label="城市"
                        prop="city"
                      ></el-table-column>
                      <el-table-column label="状态">
                        <template #default="scope">
                          <el-tag
                            :type="scope.row.state === '成功' ? 'success' : 'warning'"
                          >
                            {{ scope.row.state }}
                          </el-tag>
                        </template>
                      </el-table-column>
                      <el-table-column label="操作" width="120">
                        <template #default="scope">
                          <el-button
                            type="primary"
                            size="small"
                            @click="handlePublish(scope.row)"
                          >
                            Publish
                          </el-button>
                        </template>
                      </el-table-column>
                    </el-table>
                  </div>
                </div>
                <!-- 添加信息 -->
                <a-form layout="inline">
                  <a-form-item label="">
                    <a-select v-model:value="defaultRole" style="width: 120px">
                      <a-select-option value="默认角色"
                        >默认角色</a-select-option
                      >
                      <a-select-option value="特殊角色"
                        >特殊角色</a-select-option
                      >
                    </a-select>
                  </a-form-item>
                  <a-form-item label="">
                    <a-select v-model:value="defaultRole2" style="width: 120px">
                      <a-select-option value="门派">门派</a-select-option>
                      <a-select-option value="玩家">玩家</a-select-option>
                    </a-select>
                  </a-form-item>
                  <a-form-item label="Username">
                    <a-input
                      v-model:value="username"
                      placeholder="Username"
                      style="width: 150px"
                    />
                  </a-form-item>
                  <a-form-item label="Password">
                    <a-input
                      v-model:value="password"
                      type="password"
                      placeholder="Password"
                      style="width: 150px"
                    />
                  </a-form-item>
                  <a-form-item>
                    <a-button type="primary" @click="handleAddTableRow"
                      >添加</a-button
                    >
                  </a-form-item>

                  <div style="flex: 1"></div>

                  <a-form-item style="margin-right: 8px">
                    <a-button type="primary" @click="handleBackup">
                      <template #icon>
                        <component
                          :is="icons.DownloadOutlined"
                          style="margin-right: 8px"
                        />
                      </template>
                      备份数据
                    </a-button>
                  </a-form-item>
                  <a-form-item>
                    <a-button @click="handleImport">
                      <template #icon>
                        <component
                          :is="icons.UploadOutlined"
                          style="margin-right: 8px"
                        />
                      </template>
                      导入备份
                    </a-button>
                  </a-form-item>
                </a-form>

                <div style="margin-top: 32px">
                  <div style="margin-bottom: 16px">
                    <a-button type="primary" @click="triggerFileInput">
                      <template #icon>
                        <component
                          :is="icons.FileTextOutlined"
                          style="margin-right: 8px"
                        />
                      </template>
                      读取文本
                    </a-button>
                    <a-button style="margin-left: 8px" @click="handleClearText">
                      <template #icon>
                        <component
                          :is="icons.DeleteOutlined"
                          style="margin-right: 8px"
                        />
                      </template>
                      清空
                    </a-button>
                  </div>
                  <input
                    type="file"
                    ref="fileInput"
                    accept=".txt"
                    style="display: none"
                    @change="handleFileChange"
                  />
                  <a-textarea
                    v-model:value="textContent"
                    :rows="6"
                    placeholder="显示文本内容"
                    style="resize: none; width: 100%; min-height: 300px"
                  />
                </div>
              </a-col>
            </a-row>

            <!-- 关于页面内容 -->
            <div
              v-if="activeTab === '2'"
              style="background-color: #f5f5f5; padding: 20px 0"
            >
              <div
                style="
                  max-width: 800px;
                  margin: 0 auto;
                  padding: 20px;
                  background-color: #fff;
                  border-radius: 10px;
                "
              >
                <h1
                  style="
                    font-size: 28px;
                    font-weight: bold;
                    margin-bottom: 24px;
                  "
                >
                  关于控制台说明
                </h1>
                <p>标题。</p>

                <h2 style="font-size: 20px; margin: 32px 0 16px">主要功能</h2>
                <ul style="padding-left: 20px">
                  <li>aaaaaaaaa</li>
                </ul>

                <h2 style="font-size: 20px; margin: 32px 0 16px">技能设置</h2>
                <ul style="padding-left: 20px">
                  <li>bbbbbbbbbb</li>
                </ul>

                <h2 style="font-size: 20px; margin: 32px 0 16px">更新日志</h2>
                <ul style="padding-left: 20px">
                  <li>
                    <strong>2025.02.21: 版本1.0.8</strong>
                    <ul style="margin-top: 8px">
                      <li>增加自动高亮功能（试用）</li>
                    </ul>
                  </li>
                  <li style="margin-top: 16px">
                    <strong>2025.02.19: 版本1.0.7</strong>
                    <ul style="margin-top: 8px">
                      <li>增加10人副本至20人副本模型显示效果</li>
                    </ul>
                  </li>
                  <li style="margin-top: 16px">
                    <strong>2025.02.17: 版本1.0.6</strong>
                    <ul style="margin-top: 8px">
                      <li>ddddddddd</li>
                    </ul>
                  </li>
                </ul>

                <h2 style="font-size: 20px; margin: 32px 0 16px">使用说明</h2>
                <ul style="padding-left: 20px">
                  <li>eeeeeeeeeeeeeeeee</li>
                </ul>

                <h2 style="font-size: 20px; margin: 32px 0 16px">联系我们</h2>
                <p>
                  如果您有任何建议或发现任何问题，欢迎通过以下方式联系我们：
                </p>
                <div style="text-align: center; margin-top: 20px">
                  <img src="" style="width: 200px; margin: 0 auto" />
                  <p style="margin-top: 10px; color: #666">加入群聊</p>
                </div>
              </div>
            </div>
          </a-layout-content>
        </a-layout>
      </a-layout>
    </div>
    <script>
      const { createApp, ref, h, reactive, onMounted, nextTick } = Vue;
      const {
        Layout,
        Card,
        Timeline,
        Row,
        Col,
        Table,
        Form,
        Select,
        Divider,
        Input,
        Button,
        message,
        Modal,
        DownloadOutlined,
        UploadOutlined,
        FileTextOutlined,
        DeleteOutlined,
        Tabs,
        TabPane,
        Tree,
      } = antd;

      // 确保图标库正确引入
      const icons = {
        // 搜索图标
        SearchOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "search",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.6-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 下载图标
        DownloadOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "download",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 上传图标
        UploadOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "upload",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 文件图标
        FileTextOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "file-text",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 删除图标
        DeleteOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "delete",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 向下图标
        DownOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "down",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 向右图标
        RightOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "right",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 添加文件图标
        FileAddOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "file-add",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 播放图标
        PlayCircleOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "play-circle",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",
                  }),
                  h("path", {
                    d: "M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z",
                  }),
                ]
              ),
            ]);
          },
        },
        // 编辑图标
        EditOutlined: {
          render() {
            return h("span", { class: "custom-icon" }, [
              h(
                "svg",
                {
                  viewBox: "64 64 896 896",
                  focusable: "false",
                  "data-icon": "edit",
                  width: "1em",
                  height: "1em",
                  fill: "currentColor",
                },
                [
                  h("path", {
                    d: "M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z",
                  }),
                ]
              ),
            ]);
          },
        },
      };

      // 使用自定义图标
      const iconsLoaded = true;

      const app = createApp({
        setup() {
          const { nextTick } = Vue;

          // 用于存储游戏路径
          const user = ref("");

          const tableData = ref([
            {
              date: "2024-03-16",
              name: "张三",
              city: "上海",
              state: "成功",
              address: "上海市浦东新区陆家嘴金融贸易区",
              phone: "13800138000",
              notes: "重要客户，优先处理",
            },
            {
              date: "2024-03-15",
              name: "李四",
              city: "北京",
              state: "处理中",
              address: "北京市朝阳区建国路88号",
              phone: "13900139000",
              notes: "需要跟进",
            },
            {
              date: "2024-03-14",
              name: "王五",
              city: "广州",
              state: "成功",
              address: "广州市天河区珠江新城",
              phone: "13700137000",
              notes: "常规订单",
            },
          ]);
          const activeTab = ref("1");
          const onlineUsers = ref(132);
          const defaultRole = ref("默认角色");
          const defaultRole2 = ref("门派");
          const username = ref("");
          const password = ref("");
          const newScriptName = ref("");
          const expandedRowKeys = ref([]);
          const isModalVisible = ref(false);
          const currentRecord = ref(null);
          const scriptContent = ref("");
          const activeTabKey = ref("1");
          const scriptTreeData = ref([
            {
              title: "新建文件夹1",
              key: "folder-1",
              children: [
                {
                  title: "存仓.lua",
                  key: "1-1",
                  isLeaf: true,
                },
                {
                  title: "多任务模式.lua",
                  key: "1-2",
                  isLeaf: true,
                },
                {
                  title: "琥珀实战任务.lua",
                  key: "1-3",
                  isLeaf: true,
                },
              ],
            },
            {
              title: "新建文件夹2",
              key: "folder-2",
              children: [
                {
                  title: "开拍实行任务.lua",
                  key: "2-1",
                  isLeaf: true,
                },
                {
                  title: "蓝色飞行变身任务.lua",
                  key: "2-2",
                  isLeaf: true,
                },
                {
                  title: "蓝色猎骑变身任务.lua",
                  key: "2-3",
                  isLeaf: true,
                },
                {
                  title: "全自动1-23级蓝色号角合成.lua",
                  key: "2-4",
                  isLeaf: true,
                },
              ],
            },
          ]);

          const onExpand = (record) => {
            const key = record.key;
            const isExpanded = expandedRowKeys.value.includes(key);
            if (isExpanded) {
              expandedRowKeys.value = expandedRowKeys.value.filter(
                (k) => k !== key
              );
            } else {
              expandedRowKeys.value = [...expandedRowKeys.value, key];
            }
          };

          const switchTab = (key) => {
            activeTab.value = key;
          };

          onMounted(() => {
            // 默认展开所有行
            expandedRowKeys.value = dataSource.map((item) => item.key);
          });

          const updateLogs = [
            {
              date: "2025.03.10",
              version: "2.0.0",
              changes: ["版面优化，交互优化", "代码重构（可能有BUG）"],
              status: "success",
            },
            {
              date: "2025.03.05",
              version: "1.1.2",
              changes: ["增加神兵特效", "增加主界面显示特效"],
              status: "processing",
            },
            {
              date: "2025.02.28",
              version: "1.1.1",
              changes: [
                "优化装备快速筛选功能",
                "修复若干装备错误",
                "增加图片分享功能演示视频",
              ],
              status: "processing",
            },
          ];

          const columns = [
            { title: "姓名", dataIndex: "name", key: "name" },
            { title: "年龄", dataIndex: "age", key: "age" },
            { title: "地址", dataIndex: "address", key: "address" },
            {
              title: "操作",
              key: "action",
              scopedSlots: { customRender: "action" },
            },
          ];
          const data = [
            {
              id: 1,
              name: "张三",
              age: 32,
              address: "西湖区湖底公园1号",
              expandedContent: "这是一些关于张三的更多信息。",
            },
            {
              id: 2,
              name: "李四",
              age: 24,
              address: "东山区和平路2号",
              expandedContent: "这是一些关于李四的更多信息。",
            },
          ];
          // 表格数据
          const dataSource = reactive([
            {
              id: 1,
              key: "1",
              name: "Screen",
              platform: "iOS",
              expandedContent: "这是一些关于张三的更多信息。",
              version: "10.3.4.5654",
              upgraded: 500,
              creator: "Jack",
              date: "2014-12-24 23:12:00",
              action: "Publish",
              expandable: true,
            },
            {
              id: 2,
              key: "2",
              name: "Screen",
              platform: "iOS",
              version: "10.3.4.5654",
              upgraded: 500,
              expandedContent: "这是一些关于李四的更多信息。",
              creator: "Jack",
              date: "2014-12-24 23:12:00",
              action: "Publish",
              expandable: true,
            },
          ]);

          // 表格列定义
          const expandColumns = [
            {
              title: "Name",
              dataIndex: "name",
              key: "name",
            },
            {
              title: "Platform",
              dataIndex: "platform",
              key: "platform",
            },
            {
              title: "Version",
              dataIndex: "version",
              key: "version",
            },
            {
              title: "Upgraded",
              dataIndex: "upgraded",
              key: "upgraded",
            },
            {
              title: "Creator",
              dataIndex: "creator",
              key: "creator",
            },
            {
              title: "Date",
              dataIndex: "date",
              key: "date",
            },
            {
              title: "操作",
              key: "action",
              width: 200,
              align: "center",
              customRender: ({ record }) => {
                return h(
                  "div",
                  {
                    style: {
                      display: "flex",
                      justifyContent: "center",
                      gap: "8px",
                    },
                  },
                  [
                    h(
                      "a",
                      {
                        style: {
                          color: "#1677FF",
                          cursor: "pointer",
                        },
                        onClick: () => onExpand(record),
                      },
                      expandedRowKeys.value.includes(record.key)
                        ? "收起"
                        : "展开"
                    ),
                    h(
                      "a",
                      {
                        style: {
                          color: "#1677FF",
                          cursor: "pointer",
                          marginLeft: "8px",
                        },
                        onClick: () => handlePublish(record),
                      },
                      "Publish"
                    ),
                  ]
                );
              },
            },
          ];

          // 初始化数据
          dataSource.forEach((item) => {
            item.expanded = false;
          });

          const textContent = ref("");

          const fileInput = ref(null);

          // 触发文件选择
          const triggerFileInput = () => {
            // 确保 DOM 已经挂载
            nextTick(() => {
              if (fileInput.value) {
                fileInput.value.click();
              }
            });
          };

          // 处理文件选择变化
          const handleFileChange = (event) => {
            const file = event.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (e) => {
                textContent.value = e.target.result;
                message.success("文本加载成功");
              };
              reader.onerror = () => {
                message.error("文件读取失败");
              };
              reader.readAsText(file, "UTF-8");
              // 清空文件输入框的值，这样可以重复选择同一个文件
              event.target.value = "";
            }
          };

          const handleLoadText = () => {
            console.log("读取文本");
            message.success("文本加载成功");
            textContent.value =
              "这是从文件中读取的示例文本内容。\n可以在这里显示txt文件的内容。";
          };

          const handleClearText = () => {
            console.log("清空文本");
            textContent.value = "";
            message.info("文本已清空");
          };

          const handleBackup = () => {
            console.log("备份数据");
            message.success("数据已备份");
          };

          const handleImport = () => {
            console.log("导入备份");
            message.success("备份已导入");
          };

          const handlePublish = (record) => {
            currentRecord.value = record;
            isModalVisible.value = true;
          };

          const handleModalOk = () => {
            message.success(`发布数据成功`);
            isModalVisible.value = false;
          };

          const handleModalCancel = () => {
            isModalVisible.value = false;
          };

          const handleAdd = () => {
            // 定位下拉框的值
            if (!defaultRole.value || !defaultRole2.value) {
              message.warning("请先选择角色类型和门派/玩家类型");
              return;
            }

            console.log(
              `定位到的下拉框值 - 角色类型: ${defaultRole.value}, 类型: ${defaultRole2.value}`
            );

            // 打开脚本设置模态框
            isModalVisible.value = true;

            // 根据选择的下拉框值来展开相应的脚本树节点
            nextTick(() => {
              let folderKey = "";
              let scriptKey = "";
              let scriptName = "";

              // 根据选择的角色和类型来预选脚本
              if (
                defaultRole.value === "默认角色" &&
                defaultRole2.value === "门派"
              ) {
                folderKey = "folder-1";
                scriptKey = "1-1";
                scriptName = "存仓.lua";
              } else if (
                defaultRole.value === "默认角色" &&
                defaultRole2.value === "玩家"
              ) {
                folderKey = "folder-1";
                scriptKey = "1-2";
                scriptName = "多任务模式.lua";
              } else if (
                defaultRole.value === "特殊角色" &&
                defaultRole2.value === "门派"
              ) {
                folderKey = "folder-1";
                scriptKey = "1-3";
                scriptName = "琥珀实战任务.lua";
              } else if (
                defaultRole.value === "特殊角色" &&
                defaultRole2.value === "玩家"
              ) {
                folderKey = "folder-2";
                scriptKey = "2-1";
                scriptName = "开拍实行任务.lua";
              }

              // 先展开对应的文件夹
              selectedScriptKeys.value = [folderKey, scriptKey];

              // 选择对应的脚本文件
              selectedFileName.value = scriptName;
              selectedScriptFile.value = scriptName;

              // 更新路径信息
              user.value = `${defaultRole.value}/${defaultRole2.value}`;

              // 根据脚本名称设置不同的脚本内容示例
              // 使用查找方法找到对应的脚本节点
              let scriptContent = "";
              if (scriptName === "存仓.lua") {
                scriptContent = `-- 存仓.lua
-- 这是默认角色门派脚本
-- 功能：自动存仓功能
function main()
  -- 打开仓库界面
  openRepository()
  -- 循环检查物品
  checkItems()
  -- 存放物品
  storeItems()
  return 0
end

function openRepository()
  -- 打开仓库代码
  print("打开仓库...")
end

function checkItems()
  -- 检查物品代码
  print("检查物品...")
end

function storeItems()
  -- 存放物品代码
  print("存放物品...")
end

main()`;
              } else if (scriptName === "多任务模式.lua") {
                scriptContent = `-- 多任务模式.lua
-- 这是默认角色玩家脚本
-- 功能：执行多个任务
function main()
  -- 初始化任务列表
  local tasks = initTasks()
  -- 执行任务
  executeTasks(tasks)
  return 0
end

function initTasks()
  -- 初始化任务列表
  print("初始化任务...")
  return {"任务1", "任务2", "任务3"}
end

function executeTasks(tasks)
  -- 执行任务
  for i, task in ipairs(tasks) do
    print("执行任务: " .. task)
  end
end

main()`;
              } else if (scriptName === "琥珀实战任务.lua") {
                scriptContent = `-- 琥珀实战任务.lua
-- 这是特殊角色门派脚本
-- 功能：完成琥珀实战任务
function main()
  -- 接取任务
  acceptQuest()
  -- 寻找目标
  findTarget()
  -- 战斗
  battle()
  -- 完成任务
  completeQuest()
  return 0
end

function acceptQuest()
  -- 接取任务代码
  print("接取琥珀实战任务...")
end

function findTarget()
  -- 寻找目标代码
  print("寻找目标...")
end

function battle()
  -- 战斗代码
  print("开始战斗...")
end

function completeQuest()
  -- 完成任务代码
  print("完成琥珀实战任务...")
end

main()`;
              } else if (scriptName === "开拍实行任务.lua") {
                scriptContent = `-- 开拍实行任务.lua
-- 这是特殊角色玩家脚本
-- 功能：执行开拍任务
function main()
  -- 准备拍卖物品
  prepareItems()
  -- 设置价格
  setPrices()
  -- 发布拍卖
  publishAuction()
  -- 监控拍卖
  monitorAuction()
  return 0
end

function prepareItems()
  -- 准备拍卖物品代码
  print("准备拍卖物品...")
end

function setPrices()
  -- 设置价格代码
  print("设置价格...")
end

function publishAuction()
  -- 发布拍卖代码
  print("发布拍卖...")
end

function monitorAuction()
  -- 监控拍卖代码
  print("监控拍卖...")
end

main()`;
              }

              // 设置脚本内容
              currentScriptContent.value = scriptContent;

              // 模拟点击脚本树中的对应节点，确保UI状态一致
              handleScriptFileSelect(scriptName);

              // 激活脚本树面板
              if (activeTabKey && typeof activeTabKey.value !== "undefined") {
                activeTabKey.value = "1"; // 假设脚本树在第一个标签页
              }

              message.success(
                `已定位到${defaultRole.value}/${defaultRole2.value}对应的脚本: ${scriptName}`
              );
            });
          };

          const scriptFileInput = ref(null);
          const selectedFileName = ref("");

          const openScriptFile = () => {
            scriptFileInput.value.click();
          };

          const handleScriptFileChange = (event) => {
            const file = event.target.files[0];
            if (file) {
              selectedFileName.value = file.name;
              message.success(`已选择文件: ${file.name}`);
            }
            // 清空文件输入以允许选择相同文件
            event.target.value = "";
          };

          const selectedScriptKeys = ref([]);

          // 处理脚本文件选择函数
          const handleScriptFileSelect = (value) => {
            // 更新选中的文件名
            selectedFileName.value = value;
            selectedScriptFile.value = value;

            // 在脚本树中找到对应的节点并模拟选中
            const scriptNodes = scriptTreeData.value.reduce((acc, folder) => {
              if (folder.children) {
                return [...acc, ...folder.children];
              }
              return acc;
            }, []);

            const targetScript = scriptNodes.find(
              (node) => node.title === value
            );
            if (targetScript) {
              selectedScriptKeys.value = [targetScript.key];

              // 根据脚本名称设置不同的脚本内容
              let scriptContent = "";
              if (value === "存仓.lua") {
                scriptContent = `-- 存仓.lua
-- 这是默认角色门派脚本
-- 功能：自动存仓功能
function main()
  -- 打开仓库界面
  openRepository()
  -- 循环检查物品
  checkItems()
  -- 存放物品
  storeItems()
  return 0
end

function openRepository()
  -- 打开仓库代码
  print("打开仓库...")
end

function checkItems()
  -- 检查物品代码
  print("检查物品...")
end

function storeItems()
  -- 存放物品代码
  print("存放物品...")
end

main()`;
              } else if (value === "多任务模式.lua") {
                scriptContent = `-- 多任务模式.lua
-- 这是默认角色玩家脚本
-- 功能：执行多个任务
function main()
  -- 初始化任务列表
  local tasks = initTasks()
  -- 执行任务
  executeTasks(tasks)
  return 0
end

function initTasks()
  -- 初始化任务列表
  print("初始化任务...")
  return {"任务1", "任务2", "任务3"}
end

function executeTasks(tasks)
  -- 执行任务
  for i, task in ipairs(tasks) do
    print("执行任务: " .. task)
  end
end

main()`;
              } else if (value === "琥珀实战任务.lua") {
                scriptContent = `-- 琥珀实战任务.lua
-- 这是特殊角色门派脚本
-- 功能：完成琥珀实战任务
function main()
  -- 接取任务
  acceptQuest()
  -- 寻找目标
  findTarget()
  -- 战斗
  battle()
  -- 完成任务
  completeQuest()
  return 0
end

function acceptQuest()
  -- 接取任务代码
  print("接取琥珀实战任务...")
end

function findTarget()
  -- 寻找目标代码
  print("寻找目标...")
end

function battle()
  -- 战斗代码
  print("开始战斗...")
end

function completeQuest()
  -- 完成任务代码
  print("完成琥珀实战任务...")
end

main()`;
              } else if (value === "开拍实行任务.lua") {
                scriptContent = `-- 开拍实行任务.lua
-- 这是特殊角色玩家脚本
-- 功能：执行开拍任务
function main()
  -- 准备拍卖物品
  prepareItems()
  -- 设置价格
  setPrices()
  -- 发布拍卖
  publishAuction()
  -- 监控拍卖
  monitorAuction()
  return 0
end

function prepareItems()
  -- 准备拍卖物品代码
  print("准备拍卖物品...")
end

function setPrices()
  -- 设置价格代码
  print("设置价格...")
end

function publishAuction()
  -- 发布拍卖代码
  print("发布拍卖...")
end

function monitorAuction()
  -- 监控拍卖代码
  print("监控拍卖...")
end

main()`;
              } else {
                // 默认脚本内容
                scriptContent = `-- ${value}
-- 这是新的脚本内容

-- 在这里编写脚本代码
function main()
  print("Hello World!")
  return 0
end

main()`;
              }

              // 设置当前脚本内容
              currentScriptContent.value = scriptContent;
            }

            message.success(`已选择脚本: ${value}`);
          };

          const handleScriptSelect = (selectedKeys, info) => {
            console.log("选中的节点信息:", info.node);
            selectedScriptKeys.value = selectedKeys;

            if (info.node.isLeaf) {
              // 如果是脚本文件，显示文件名
              currentScriptContent.value = `-- ${info.node.title}`;
            } else {
              // 如果选中的是文件夹，清空内容
              currentScriptContent.value = "";
            }
          };

          const handleNewScript = () => {
            if (!newScriptName.value) {
              message.error("请输入脚本文件名");
              return;
            }

            const fileName = newScriptName.value.endsWith(".lua")
              ? newScriptName.value
              : newScriptName.value + ".lua";

            // 获取当前选中的节点
            const selectedKey = selectedScriptKeys.value[0];

            // 如果没有选中节点，直接添加到根目录
            if (!selectedKey) {
              scriptTreeData.value.push({
                title: fileName,
                key: fileName,
                isLeaf: true,
              });
              scriptTreeData.value = [...scriptTreeData.value];
              message.success("新建脚本成功");
              newScriptName.value = "";
              return;
            }

            // 在树数据中查找选中的节点
            const findNode = (nodes) => {
              for (const node of nodes) {
                if (node.key === selectedKey) {
                  return node;
                }
                if (node.children) {
                  const found = findNode(node.children);
                  if (found) return found;
                }
              }
              return null;
            };

            // 如果有选中节点，检查是否是文件夹
            const selectedNode = findNode(scriptTreeData.value);
            if (selectedNode && selectedNode.isLeaf) {
              message.error("请选择一个文件夹，而不是脚本文件");
              return;
            }

            if (selectedNode) {
              // 在选中的文件夹下创建脚本
              if (!selectedNode.children) {
                selectedNode.children = [];
              }

              selectedNode.children.push({
                title: fileName,
                key: fileName,
                isLeaf: true,
              });

              // 强制更新数据以触发视图更新
              scriptTreeData.value = [...scriptTreeData.value];
              message.success("新建脚本成功");
              newScriptName.value = ""; // 清空输入
            }
          };

          const handleDeleteScript = () => {
            if (!selectedScriptKeys.value.length) {
              message.warning("请先选择要删除的脚本");
              return;
            }

            const selectedKey = selectedScriptKeys.value[0];

            // 递归查找并删除脚本
            const removeScript = (nodes) => {
              for (let i = 0; i < nodes.length; i++) {
                const node = nodes[i];
                if (node.children) {
                  // 在子节点中查找要删除的脚本
                  const scriptIndex = node.children.findIndex(
                    (child) => child.key === selectedKey
                  );
                  if (scriptIndex !== -1) {
                    // 找到脚本，从children数组中删除
                    node.children.splice(scriptIndex, 1);
                    return true;
                  }
                  // 继续在子文件夹中查找
                  if (removeScript(node.children)) {
                    return true;
                  }
                }
              }
              return false;
            };

            Modal.confirm({
              title: "确认删除",
              content: "确定要删除选中的脚本吗？此操作不可恢复。",
              okText: "确认",
              cancelText: "取消",
              onOk() {
                if (removeScript(scriptTreeData.value)) {
                  selectedScriptKeys.value = []; // 清空选中
                  // 强制更新scriptTreeData以触发视图更新
                  scriptTreeData.value = [...scriptTreeData.value];
                  message.success("删除脚本成功");
                } else {
                  message.error("删除脚本失败");
                }
              },
            });
          };

          const handleRunScript = () => {
            if (!selectedScriptKeys.value.length) {
              message.warning("请先选择要运行的脚本");
              return;
            }
            // 获取选中的脚本名称
            const selectedScript = scriptTreeData.value.find(
              (item) => item.key === selectedScriptKeys.value[0]
            );
            message.success(`正在运行脚本: ${selectedScript.title}`);
          };

          const scriptNameInput = ref("");

          const handleStart = () => {
            message.success("启动成功");
          };

          const handleStop = () => {
            message.success("已停止");
          };

          // 在setup函数中添加新的ref变量
          const settingsContent = ref("");
          const huntingContent = ref("");
          const protectContent = ref("");
          const teamContent = ref("");
          const itemContent = ref("");
          const recordContent = ref("");

          // 录制标签页相关数据
          const coordinateList = ref([
            { key: "1", coordinate: "100,200" },
            { key: "2", coordinate: "150,250" },
            { key: "3", coordinate: "200,300" },
          ]);
          const coordinateNameList = ref([
            { key: "1", name: "城镇入口" },
            { key: "2", name: "商店" },
            { key: "3", name: "传送点" },
          ]);
          const selectedCoordinateIndex = ref(-1);
          const selectedCoordinateNameIndex = ref(-1);
          const newCoordinate = ref("");
          const newCoordinateName = ref("");
          const selectedCommand = ref("command1");
          const monsterType = ref("attack");

          // 坐标操作方法
          const selectCoordinate = (index) => {
            selectedCoordinateIndex.value =
              selectedCoordinateIndex.value === index ? -1 : index;
          };

          const addCoordinate = () => {
            if (!newCoordinate.value) {
              message.warning("请输入坐标");
              return;
            }
            const key = (coordinateList.value.length + 1).toString();
            coordinateList.value.push({
              key,
              coordinate: newCoordinate.value,
            });
            newCoordinate.value = "";
            message.success("添加坐标成功");
          };

          const deleteCoordinate = () => {
            if (selectedCoordinateKeys.value.length === 0) {
              message.warning("请先选择要删除的坐标");
              return;
            }
            const selectedKey = selectedCoordinateKeys.value[0];
            const selectedItem = coordinateList.value.find(
              (item) => item.key === selectedKey
            );

            Modal.confirm({
              title: "确认删除",
              content: `确定要删除坐标 "${selectedItem.coordinate}" 吗？`,
              onOk() {
                const index = coordinateList.value.findIndex(
                  (item) => item.key === selectedKey
                );
                coordinateList.value.splice(index, 1);
                // 重新生成key
                coordinateList.value = coordinateList.value.map(
                  (item, idx) => ({
                    ...item,
                    key: (idx + 1).toString(),
                  })
                );
                selectedCoordinateKeys.value = []; // 清空选中
                message.success("删除坐标成功");
              },
            });
          };

          const clearCoordinates = () => {
            Modal.confirm({
              title: "确认清空",
              content: "确定要清空所有坐标吗？此操作不可恢复。",
              onOk() {
                coordinateList.value = [];
                selectedCoordinateIndex.value = -1;
                message.success("已清空所有坐标");
              },
            });
          };

          // 坐标名操作方法
          const selectCoordinateName = (index) => {
            selectedCoordinateNameIndex.value =
              selectedCoordinateNameIndex.value === index ? -1 : index;
          };

          const addCoordinateName = () => {
            if (!newCoordinateName.value) {
              message.warning("请输入怪物名");
              return;
            }
            const key = (coordinateNameList.value.length + 1).toString();
            coordinateNameList.value.push({
              key,
              name: newCoordinateName.value,
              type: monsterType.value,
            });
            newCoordinateName.value = "";
            message.success("添加怪物名成功");
          };

          // 手动添加怪物名
          const manualAddCoordinateName = () => {
            if (!newCoordinateName.value) {
              message.warning("请输入怪物名");
              return;
            }
            const key = (coordinateNameList.value.length + 1).toString();
            coordinateNameList.value.push({
              key,
              name: newCoordinateName.value,
              type: monsterType.value,
            });
            newCoordinateName.value = "";
            message.success("手动添加怪物名成功");
          };

          // 复制名字列表
          const copyNameList = () => {
            if (coordinateNameList.value.length === 0) {
              message.warning("没有怪物名可复制");
              return;
            }

            // 构建名字列表字符串
            let nameList = "";
            coordinateNameList.value.forEach((item) => {
              nameList += `${item.name}\n`;
            });

            // 复制到剪贴板
            navigator.clipboard
              .writeText(nameList)
              .then(() => {
                message.success("已复制名字列表到剪贴板");
              })
              .catch((err) => {
                message.error("复制失败: " + err);
              });
          };

          const deleteCoordinateName = () => {
            if (selectedCoordinateNameIndex.value === -1) {
              message.warning("请先选择要删除的坐标名");
              return;
            }

            const selectedName =
              coordinateNameList.value[selectedCoordinateNameIndex.value].name;

            Modal.confirm({
              title: "删除确认",
              content: h("div", {}, [
                h("p", "您确定要删除这个怪物名吗？"),
                h(
                  "p",
                  { style: "color: #ff4d4f; margin-top: 8px" },
                  `怪物名称: "${selectedName}"`
                ),
                h(
                  "p",
                  { style: "color: #666; font-size: 12px; margin-top: 8px" },
                  "删除后将无法恢复，请谨慎操作"
                ),
              ]),
              okText: "确认删除",
              okButtonProps: {
                danger: true,
              },
              cancelText: "取消",
              onOk() {
                coordinateNameList.value.splice(
                  selectedCoordinateNameIndex.value,
                  1
                );
                coordinateNameList.value = coordinateNameList.value.map(
                  (item, idx) => ({
                    ...item,
                    key: (idx + 1).toString(),
                  })
                );
                message.success("删除怪物名成功");
                selectedCoordinateNameIndex.value = -1;
              },
            });
          };

          const clearCoordinateNames = () => {
            Modal.confirm({
              title: "确认清空",
              content: "确定要清空所有坐标名吗？此操作不可恢复。",
              onOk() {
                coordinateNameList.value = [];
                selectedCoordinateNameIndex.value = -1;
                message.success("已清空所有坐标名");
              },
            });
          };

          // 命令执行方法
          const executeCommand = () => {
            message.info(`执行命令: ${selectedCommand.value}`);
          };

          // 复制全部路径格式lua
          const copyPathFormat = () => {
            if (coordinateList.value.length === 0) {
              message.warning("没有坐标可复制");
              return;
            }

            // 构建lua格式的路径字符串
            let luaCode = "local path = {\n";
            coordinateList.value.forEach((item, index) => {
              const name = coordinateNameList.value[index]
                ? coordinateNameList.value[index].name
                : "";
              luaCode += `  {${item.coordinate}, "${name}"},\n`;
            });
            luaCode += "}\n\nreturn path";

            // 复制到剪贴板
            navigator.clipboard
              .writeText(luaCode)
              .then(() => {
                message.success("已复制全部路径格式到剪贴板");
              })
              .catch((err) => {
                message.error("复制失败: " + err);
              });
          };

          // 生成路径格式
          const generatePathFormat = () => {
            if (coordinateList.value.length === 0) {
              message.warning("没有坐标可生成路径");
              return;
            }

            // 生成路径格式
            let pathFormat = "";
            coordinateList.value.forEach((item, index) => {
              const name = coordinateNameList.value[index]
                ? coordinateNameList.value[index].name
                : "";
              pathFormat += `${item.coordinate} - ${name}\n`;
            });

            // 显示生成的路径格式
            Modal.info({
              title: "生成的路径格式",
              content: h("div", {}, [
                h(
                  "pre",
                  { style: "max-height: 300px; overflow-y: auto;" },
                  pathFormat
                ),
              ]),
              width: 500,
            });
          };

          // 获取当前地图ID
          const getCurrentMapId = () => {
            // 模拟获取当前地图ID
            const mapId = Math.floor(Math.random() * 10000);
            message.success(`当前地图ID: ${mapId}`);
          };

          const currentMapId = ref("");

          const currentScriptContent = ref("");

          // 修改坐标方法
          const modifyCoordinate = () => {
            if (selectedCoordinateKeys.value.length === 0) {
              message.warning("请先选择要修改的坐标");
              return;
            }

            const selectedKey = selectedCoordinateKeys.value[0];
            const selectedItem = coordinateList.value.find(
              (item) => item.key === selectedKey
            );

            if (!selectedItem) {
              message.error("未找到选中的坐标");
              return;
            }

            newCoordinate.value = selectedItem.coordinate;

            Modal.confirm({
              title: "修改坐标",
              content: h("div", {}, [
                h("p", "请修改坐标值:"),
                h(Input, {
                  value: newCoordinate.value,
                  onChange: (e) => (newCoordinate.value = e.target.value),
                }),
              ]),
              onOk() {
                if (!newCoordinate.value) {
                  message.error("坐标不能为空");
                  return;
                }
                const index = coordinateList.value.findIndex(
                  (item) => item.key === selectedKey
                );
                if (index !== -1) {
                  coordinateList.value[index].coordinate = newCoordinate.value;
                  message.success("修改坐标成功");
                  newCoordinate.value = "";
                }
              },
            });
          };

          // 修改怪物名方法
          const modifyCoordinateName = () => {
            if (selectedCoordinateNameIndex.value === -1) {
              message.warning("请先选择要修改的怪物名");
              return;
            }

            // 将选中的怪物名填入输入框
            newCoordinateName.value =
              coordinateNameList.value[selectedCoordinateNameIndex.value].name;

            // 弹出确认对话框
            Modal.confirm({
              title: "修改怪物名",
              content: h("div", {}, [
                h("p", "请修改怪物名:"),
                h(Input, {
                  value: newCoordinateName.value,
                  onChange: (e) => (newCoordinateName.value = e.target.value),
                }),
              ]),
              onOk() {
                if (!newCoordinateName.value) {
                  message.error("怪物名不能为空");
                  return;
                }
                // 更新怪物名
                coordinateNameList.value[
                  selectedCoordinateNameIndex.value
                ].name = newCoordinateName.value;
                message.success("修改怪物名成功");
                newCoordinateName.value = ""; // 清空输入框
              },
            });
          };

          // 编辑坐标方法
          const handleEditCoordinate = (record, index) => {
            selectedCoordinateIndex.value = index;
            newCoordinate.value = record.coordinate;

            Modal.confirm({
              title: "修改坐标",
              content: h("div", {}, [
                h("p", "请修改坐标值:"),
                h(Input, {
                  value: newCoordinate.value,
                  onChange: (e) => (newCoordinate.value = e.target.value),
                }),
              ]),
              onOk() {
                if (!newCoordinate.value) {
                  message.error("坐标不能为空");
                  return;
                }
                // 更新坐标
                coordinateList.value[index].coordinate = newCoordinate.value;
                message.success("修改坐标成功");
                newCoordinate.value = ""; // 清空输入框
                selectedCoordinateIndex.value = -1; // 清除选中状态
              },
              onCancel() {
                newCoordinate.value = ""; // 清空输入框
                selectedCoordinateIndex.value = -1; // 清除选中状态
              },
            });
          };

          // 删除坐标方法
          const handleDeleteCoordinate = (record, index) => {
            Modal.confirm({
              title: "确认删除",
              content: `确定要删除坐标 "${record.coordinate}" 吗？`,
              onOk() {
                coordinateList.value.splice(index, 1);
                // 重新生成key
                coordinateList.value = coordinateList.value.map(
                  (item, idx) => ({
                    ...item,
                    key: (idx + 1).toString(),
                  })
                );
                message.success("删除坐标成功");
                selectedCoordinateIndex.value = -1; // 清除选中状态
              },
            });
          };

          const getRowClassName = (index) => {
            return selectedCoordinateIndex.value === index
              ? "ant-table-row-selected"
              : "";
          };

          // 添加处理编辑怪物名的方法
          const handleEditCoordinateName = (record, index) => {
            selectedCoordinateNameIndex.value = index;
            newCoordinateName.value = record.name;

            Modal.confirm({
              title: "修改怪物名",
              content: h("div", {}, [
                h("p", "请修改怪物名:"),
                h(Input, {
                  value: newCoordinateName.value,
                  onChange: (e) => (newCoordinateName.value = e.target.value),
                }),
              ]),
              onOk() {
                if (!newCoordinateName.value) {
                  message.error("怪物名不能为空");
                  return;
                }
                coordinateNameList.value[index].name = newCoordinateName.value;
                message.success("修改怪物名成功");
                newCoordinateName.value = "";
                selectedCoordinateNameIndex.value = -1;
              },
              onCancel() {
                newCoordinateName.value = "";
                selectedCoordinateNameIndex.value = -1;
              },
            });
          };

          // 添加处理删除怪物名的方法
          const handleDeleteCoordinateName = (record, index) => {
            Modal.confirm({
              title: "删除确认",
              content: h("div", {}, [
                h("p", "您确定要删除这个怪物名吗？"),
                h(
                  "p",
                  { style: "color: #ff4d4f; margin-top: 8px" },
                  `怪物名称: "${record.name}"`
                ),
                h(
                  "p",
                  { style: "color: #666; font-size: 12px; margin-top: 8px" },
                  "删除后将无法恢复，请谨慎操作"
                ),
              ]),
              okText: "确认删除",
              okButtonProps: {
                danger: true,
              },
              cancelText: "取消",
              onOk() {
                coordinateNameList.value.splice(index, 1);
                coordinateNameList.value = coordinateNameList.value.map(
                  (item, idx) => ({
                    ...item,
                    key: (idx + 1).toString(),
                  })
                );
                message.success("删除怪物名成功");
                selectedCoordinateNameIndex.value = -1;
              },
            });
          };

          // 在 setup 函数中添加
          const selectedCoordinateKeys = ref([]);

          const onCoordinateSelectChange = (selectedKeys) => {
            selectedCoordinateKeys.value = selectedKeys;
            selectedCoordinateIndex.value =
              selectedKeys.length > 0 ? selectedKeys[0] : -1;
          };

          // 在 setup 函数中添加
          const selectedCoordinateNameKeys = ref([]);

          const onCoordinateNameSelectChange = (selectedKeys) => {
            selectedCoordinateNameKeys.value = selectedKeys;
            selectedCoordinateNameIndex.value =
              selectedKeys.length > 0 ? selectedKeys[0] - 1 : -1;
          };

          const selectedScriptFile = ref("");

          // handleScriptFileSelect 已经在前面定义过了，不需要重复定义

          // 添加新的处理表格数据添加的方法
          const handleAddTableRow = () => {
            if (!username.value || !defaultRole.value || !defaultRole2.value) {
              message.warning("请填写完整信息");
              return;
            }

            // 生成新的表格数据
            const newRow = {
              date: dayjs().format("YYYY-MM-DD"),
              name: username.value,
              city: defaultRole.value,
              state: defaultRole2.value,
              address: `${defaultRole.value}/${defaultRole2.value}`,
              phone: password.value || "未设置",
              notes: "新添加的数据",
            };

            // 添加到表格数据中
            tableData.value = [...tableData.value, newRow];

            // 清空输入框
            username.value = "";
            password.value = "";

            // 提示成功
            message.success("添加成功");
          };

          // 返回模板需要使用的数据和方法
          return {
            activeTab,
            switchTab,
            onlineUsers,
            updateLogs,
            data,
            columns,
            dataSource,
            expandColumns,
            defaultRole,
            defaultRole2,
            username,
            password,
            newScriptName,
            handlePublish,
            handleAdd,
            handleBackup,
            handleImport,
            handleLoadText,
            handleClearText,
            textContent,
            fileInput,
            triggerFileInput,
            handleFileChange,
            expandedRowKeys,
            onExpand,
            icons,
            iconsLoaded,
            isModalVisible,
            currentRecord,
            handleModalOk,
            handleModalCancel,
            scriptContent,
            scriptFileInput,
            selectedFileName,
            openScriptFile,
            handleScriptFileChange,
            activeTabKey,
            scriptTreeData,
            selectedScriptKeys,
            handleScriptSelect,
            handleNewScript,
            handleDeleteScript,
            handleRunScript,
            scriptNameInput,
            handleStart,
            handleStop,
            settingsContent,
            huntingContent,
            protectContent,
            teamContent,
            itemContent,
            recordContent,
            currentScriptContent,
            coordinateList,
            coordinateNameList,
            selectedCoordinateIndex,
            selectedCoordinateNameIndex,
            newCoordinate,
            newCoordinateName,
            selectedCommand,
            selectCoordinate,
            addCoordinate,
            deleteCoordinate,
            clearCoordinates,
            selectCoordinateName,
            addCoordinateName,
            deleteCoordinateName,
            clearCoordinateNames,
            executeCommand,
            copyPathFormat,
            generatePathFormat,
            getCurrentMapId,
            currentMapId,
            monsterType,
            manualAddCoordinateName,
            copyNameList,
            modifyCoordinate,
            modifyCoordinateName,
            handleEditCoordinate,
            handleDeleteCoordinate,
            getRowClassName,
            handleEditCoordinateName,
            handleDeleteCoordinateName,
            selectedCoordinateKeys,
            onCoordinateSelectChange,
            selectedCoordinateNameKeys,
            onCoordinateNameSelectChange,
            selectedScriptFile,
            handleScriptFileSelect,
            tableData,
            user,
            handleAddTableRow,
          };
        },
      });

      app.use(Layout);
      app.use(Card);
      app.use(Timeline);
      app.use(Row);
      app.use(Col);
      app.use(Table);
      app.use(Form);
      app.use(Select);
      app.use(Divider);
      app.use(Input);
      app.use(Button);
      app.use(message);
      app.use(Modal);
      app.use(Tabs);
      app.use(TabPane);
      app.use(Tree);
      app.use(ElementPlus);

      app.mount("#app");
    </script>
  </body>
</html>
