# 股票监控系统

这是一个基于 Flask 的股票监控系统，可以实时监控股票价格，当价格低于设定的监控价格时，会自动发送警报到企业微信群聊。

## 功能特点

- **股票监控**：实时监控股票价格，当价格低于设定的监控价格时发送警报
- **股票管理**：添加、删除股票，修改监控价格
- **数据显示**：
  - 股票名称、代码
  - 前一交易日主力净量、开盘价、收盘价、换手率
  - 5 日和 10 日均线数据
  - 交易时间内显示实时价格
- **自动更新**：每 5 秒自动更新数据，交易时间（9:30-11:30, 13:00-15:00）自动检测并更新实时价格

## 安装步骤

### 1. 克隆或下载项目

将项目文件下载到本地目录。

### 2. 创建虚拟环境（推荐）

```bash
# 创建虚拟环境
python -m venv stock_env

# 激活虚拟环境
# Windows PowerShell
.\stock_env\Scripts\Activate.ps1
# 或 Windows CMD
.\stock_env\Scripts\activate.bat
```

### 3. 安装依赖

```bash
# 安装所有依赖
pip install -r stock_requirements.txt
```

### 4. 运行应用

```bash
# 进入项目目录
cd stock_monitor

# 启动应用
python app.py
```

### 5. 访问应用

在浏览器中打开以下地址：

```
http://localhost:8080
```

## 使用说明

### 添加股票

1. 在页面顶部的表单中输入股票代码、名称和监控价格
2. 点击"添加"按钮

### 删除股票

1. 在股票卡片上找到删除按钮
2. 点击删除按钮确认删除

### 修改监控价格

1. 在股票卡片上找到监控价格输入框
2. 修改价格后点击"保存"按钮

## 警报机制

- 当股票实时价格低于设定的监控价格时，系统会自动发送警报到配置的企业微信群聊
- 警报包含股票名称、代码、当前价格和监控价格

## 数据更新

- 系统会自动每 5 秒更新一次数据
- 交易时间（9:30-11:30, 13:00-15:00）会自动检测并更新实时价格
- 非交易时间不显示实时价格

## 关于数据源

### 当前使用模拟数据的原因

系统目前使用模拟数据是因为缺少真实的股票数据 API 连接。在代码中，系统尝试导入`chinadata.ca_data`模块来获取真实数据，但如果该模块不存在，系统会自动切换到使用模拟数据。

### 配置真实数据源

要使用真实数据，您需要：

1. **安装数据源模块**：

   ```bash
   pip install chinadata
   ```

   或者使用其他股票数据 API，如 tushare、baostock 等。

2. **获取 API 密钥**：

   - 对于 Tushare API，您需要在[Tushare 官网](https://tushare.pro/)注册并获取 token
   - 当前代码中使用的 API 密钥为示例，需要替换为您自己的密钥

3. **修改 app.py 中的 API 配置**：

   ```python
   # 修改为您的API密钥
   pro = ts.pro_api('您的API密钥')
   # 如果需要，修改API URL
   pro._DataApi__http_url = '您的API服务器地址'
   ```

4. **适配不同的数据源**：
   如果使用其他数据源，您需要修改`get_stock_data`函数以适配不同的 API 返回格式。

### 替代数据源选项

如果无法使用 chinadata 模块，您可以考虑以下替代方案：

1. **Tushare 官方 API**：

   ```bash
   pip install tushare
   ```

2. **Baostock**：

   ```bash
   pip install baostock
   ```

3. **Akshare**：
   ```bash
   pip install akshare
   ```

修改相应的数据获取代码后，系统将能够显示真实的股票数据而非模拟数据。

## 系统要求

- Python 3.6+
- 所有依赖包（见 stock_requirements.txt）

## 注意事项

- 确保网络连接正常，以便获取实时股票数据
- 企业微信机器人 webhook 需要在代码中配置
- 股票数据保存在本地的 stocks.json 文件中
